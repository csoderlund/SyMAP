<!DOCTYPE html>
<html>
<head>
<title>SyMAP Collinear</title>
<style>
	a:link {color:#6666CC;text-decoration: none; background-color: transparent;}
	a:visited {color:#6666CC;text-decoration: none; background-color: transparent;}
	a:active {color:#6666CC;text-decoration: none; background-color: transparent;}
    a.white {font-family:verdana; font-size:12px; color:white; text-decoration: underline;}
    a.ext {font-weight: bold;}
    .tx td {padding: 5px;}
	.ty    {border: 1px  solid black; border-spacing: 0px;  border-collapse: collapse;}
    .ty td {border: 1px  solid black; padding: 3px; }
    mark.white {font-family:verdana; font-size:12px; color:white;background:none;}
    ttl  {font-family: 'Lucida Console', monospace; font-size: 14px; font-weight: 700; color: DarkSlateGrey;}
	ttb  {font-family: 'Lucida Console', monospace; font-size: 14px; font-weight: 700; color: Black;}
	ttx  {font-family: 'Helvetica', monospace; font-size: 14px; font-weight: 500; color: DarkSlateGrey;}
    tt {font-size:13px}
	pre {font-size:13px}
	body {font-family: Verdana, Arial, Helvetica, sans-serif;  font-size: 14px; }
</style>
</head>

<body>
<a id="top"></a>
<table style="width: 800px; border: 2px solid #999999; padding: 0; border-spacing:0; border-collapse:collapse; margin-left: auto; margin-right: auto;">
	<tr><td>
		<table style="width: 100%; border: 0px; padding: 0;  border-collapse:collapse;">
			<tr>
				<td style="text-align: left; vertical-align: top; padding: 0">
					<a href="http://www.agcol.arizona.edu">
						<img src="./img/agcol_logo.gif" alt="AGCoL" style="width: 180px; border:1px solid black"></a>
				</td>
				<td style="padding-bottom:5px; padding-left:40px; text-align: left;  font-family: Verdana, Arial; font-size: 20px; font-weight: bold;color:MidnightBlue">
					SyMAP Collinear
				</td>
				<td style="text-align: right; vertical-align: top; padding: 0">
					<a href="http://www.arizona.edu">
						<img src="./img/UA.gif" alt="UA" title="University of Arizona"  style="width: 40px; border:1px solid black"></a>
					<br>

				</td>
			</tr>
			<tr>
				<td colspan="3" style="text-align: left; vertical-align: top; padding: 0">
				<table style="width: 100%; padding: 0;  border-spacing:0; border-collapse:collapse;">
					<tr>
						<td style="background-color: #666666; padding-bottom:4px;">
						<a href="https://csoderlund.github.io/SyMAP" class="white">SyMAP Home</a> <mark class="white">|</mark>
						<a href="https://github.com/csoderlund/SyMAP/releases" class="white">Download</a> <mark class="white">|</mark>
						<a href="./Docs.html" class="white">Docs</a> <mark class="white">|</mark>
						<a href="./SystemGuide.html" class="white">System Guide</a> <mark class="white">|</mark>
						<a href="./UserGuide.html" class="white">User Guide</a> <mark class="white">|</mark>
						<a href="./Tour.html" class="white">Tour</a>
					</tr>
				</table>
				</td>
			</tr>
		</table>
	</td></tr>

	<tr><td style='vertical-align: top; text-align: left; padding:15px;'>
	<!---- START BODY -->


<h2>Details of Collinear sets</h2>
Using the <ttb>Hit Filter</ttb>, or right click in the hit region, set the highlighting for <ttl>Collinear Sets</ttl>.
As shown below, the number of highlighted collinear hits and number of collinear sets will be shown in
the <ttl>Information</ttl> box.
<br>
<a href="img/colHigh.png">
<img src="img/colHigh.png" alt="Collinear Sets" style="border: 1px solid black; width: 650px"></a>
<p>
<table>
<tr><td  style="vertical-align: text-top;">
In the image on the right, two different sets are shown (green highlighted hits is the 1st set,
pink is the 2nd). They were broken up by a gene on each chromosome
that do not have a hit.
<p><ttl>Forward (=) vs reverse (!=) sets</ttl>:
<br>a <ttl>=</ttl> hit is to the strands (+/+) or (-/-),
<br>a <ttl>!=</ttl> hit is to the strands (+/-) or (-/+).
<br>All hits in a set are either to the same strand (=) or opposite (!=).

<p>In the image on the right, all genes in both sets are on the same strand.

<p>In the image below, all genes are on opposite strands.
<br><a href="img/colRHits.png"><img src="img/colRHits.png" alt="Reverse hits" style="border: 1px solid black; width: 270px"></a>
<p>&nbsp;
<p>The collinear set algorithm does not consider the amount of overlap of the hit to a gene, or the similarity
of the hit sequences.

<td><a href="img/colSet2.png">
<img src="img/colSet2.png" alt="2 Collinear Sets" style="border: 1px solid black; width: 450px"></a>
</table>

<p>The following are examples of interpreting the 2D view:
<table>
<tr><td>
Sometimes a hit looks like it overlaps a gene, but the gene is actually in the gap, so it is not hit.
This is illustrated on the right, where the 3 genes at the bottom appear hit by the red hit wire,
but in fact are spanned by the gap gray area. Note that the
hit popup shows it is a g0 hit (hits no genes).
<td><a href="img/colG0HitsSpan.png">
<img src="img/colG0HitsSpan.png" alt="Clustered hit" style="border: 1px solid black; width: 300px"></a>
<tr><td>&nbsp;<td>&nbsp;
<tr><td   style="vertical-align: text-top;">
The image on the right shows one collinear set with 6 brown hit wires that are not part of the set. The following
explains them, using the symbols g0 (hits 0 genes), g1 (hits 1 gene), g2 (hits paired genes, at
least one on each chromosome).
<p>
<table class="ty">
<tr><td>1<td>g1<td>Ignored, not part of the set since it does not hit paired genes.
<tr><td>2<td>g0<td>Ignored.
<tr><td>3<td>g1<td>Ignored since the same gene has a hit to a paired gene.
<tr><td>4<td>g0<td>Ignored.
<tr><td>5<td>g1<td>This ends the set since it does not hit a paired gene.
<tr><td>6<td>g2<td>This could start a new set, but is not followed by another paired gene.
</table>

<p>&nbsp;<p>As shown earlier, sometimes two genes look as one, so the <ttl>Gene Delimiter</ttl> option is important to
view these.
<br><a href="img/colSetGL.png">
	<img src="img/colSetGL.png" alt="Collinear Highlight and Gene Lines" style="border: 1px solid black; width: 250px"></a>
<td><a href="img/colG1Hits.png">
<img src="img/colG1Hits.png" alt="G1 hits" style="border: 1px solid black; width: 300px"></a>
</table>
<h3>Known collinear set problems</h3>
<table>
<tr><td>
<i>Disclaimer: The collinear sets are not always correct</i>. The benefit of the 2D graphics is that the user can
determine if two sets should be merged or if a set does not appear correct.
<p>The image on the right shows the two biggest problems.
<ol>
<li>Overlapping genes: These often break a set in two, as shown on the right. The red highlighted hit
is part of the top collinear set, but the next hit should be too. This caused one set to be broken into two.
<p>
<li>Convoluted hit pattern: The lower green set has a weird hit pattern, where even visually it is hard
to tell what is going on.
</ol>
<td><a href="img/colError.png">
<img src="img/colError.png" alt="Collinear problems" style="border: 1px solid black; width: 300px"></a>
</table>
These are the only two problems I have seen, but with so many combinations of hits and overlapping genes, there
are probably others. I can fix most of the overlapping hit problems, but that will take rewriting the hit-to-gene
assignment code; hence, it will be done for another release.
<p><a href="#top">Go to Top</a>
<!---- END BODY -->
	</td></tr>
	<tr><td style="background-color: #DDDDDD; text-align: center; padding: 0; font-family: Verdana, Arial; font-size: 12px;">
                        Email Comments To: <a href="mailto:symap@agcol.arizona.edu">symap@agcol.arizona.edu</a>

</td></tr>
</table>
</body>
</html>

